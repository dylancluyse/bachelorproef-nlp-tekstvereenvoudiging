\chapter{\IfLanguageName{dutch}{Code voor tekstanalyse}{Attachment 1}}%
\label{ch:bijlage-code}

\begin{lstlisting}[language=Python, caption={Script voor fase 1 van de vergelijkende studie.}, label={code:verg-studie-phase-1}]
import os, re

def add_newline_after_dot(input_file, output_file):
	with open(input_file, 'r', encoding='utf-8') as file:
		text = file.read()
	text = re.sub(r'\d', '', text)
	modified_text = text.replace('.', '.\n')
	with open(output_file, 'w', encoding='utf-8') as file:
		file.write(modified_text)

folder_path = 'scripts\pdf'
original_scientific_papers = [f for f in os.listdir(folder_path)]

for paper in original_scientific_papers:
	input_file =  folder_path + '/' + paper
	output_file = folder_path + '/' + 'RE_' + paper
	add_newline_after_dot(input_file, output_file)
\end{lstlisting}

\newpage

\begin{center}
	\begin{lstlisting}[language=Python, caption={Script voor de tweede fase van de vergelijkende studie.}, label={code:verg-studie-phase-2}]
import os
import pandas as pd
from deep_translator import GoogleTranslator

output_csv = 'results.csv'

def translate_dutch_to_english(dutch_text_file):
	with open(dutch_text_file, 'r', encoding='utf-8') as file:
		dutch_sentences = file.readlines()
		dutch_sentences = [sentence.strip() for sentence in dutch_sentences]

	english_sentences = []
	for sentence in dutch_sentences:
		translated = GoogleTranslator(source='nl', target='en').translate(sentence)
		english_sentences.append(translated)
		df = pd.DataFrame({'Dutch': dutch_sentences, 'English': english_sentences})
		df.to_csv(str(dutch_text_file).split('.')[0] + '.csv', index=False)


	folder_path = 'scripts/pdf/'
	original_scientific_papers = [f for f in os.listdir(folder_path)]

	for paper in original_scientific_papers:
		if paper.startswith('RE_') and paper.endswith('.txt'):
			print(f'STARTING {paper}')
			dutch_text_file = folder_path + paper
			translate_dutch_to_english(dutch_text_file)
	\end{lstlisting}
\end{center}

\newpage

\begin{center}
	\begin{lstlisting}[language=Python, caption={Script voor fase 4 van de vergelijkende studie}, label={code:verg-studie-phase-4}]
import os
from langdetect import detect
import spacy
import pandas as pd
import readability

simplified_folder = 'scripts/vereenvoudigde_artikelen'
original_folder = 'scripts/pdf'

scientific_papers = [original_folder + "/" + f for f in os.listdir(original_folder)] + [simplified_folder + "/" + f for f in os.listdir(simplified_folder)]

languages = {
	'nl':'nl_core_news_md',
	'en':'en_core_web_md'
}

df = pd.DataFrame()

for paper in scientific_papers:
with open(paper, 'r', encoding='utf-8') as file:
text = file.read()
nlp = spacy.load(languages.get('nl'))
doc = nlp(text)

for sent in doc.sents:
try:
metrics = readability.getmeasures(sent.text, lang='nl')
row = {
	'Paper': paper.split('/')[2].split('.')[0],
	'Sentence': sent.text,
	'FRE': metrics['readability grades']['FleschReadingEase'],
	'FOG': metrics['readability grades']['GunningFogIndex'],
}

for key, value in metrics['sentence info'].items():
row[key] = value

for key, value in metrics['word usage'].items():
row[key] = value

for key, value in metrics['sentence beginnings'].items():
row[key] = value

df = df.append(row, ignore_index=True)
except Exception as e:
print(e)

df.to_csv('result.csv', index=False)
	\end{lstlisting}
\end{center}
